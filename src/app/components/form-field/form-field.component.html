<div class="space-y-2">
  <div class="flex justify-between items-center">
    @if (isEditing) {
      <input 
        type="text" 
        [value]="field.label"
        (input)="onLabelChange($any($event.target).value)"
        class="form-control"
        placeholder="Field Label"
      />
    } @else {
      <label class="text-lg font-medium text-gray-800">
        {{ field.label }}
        @if (field.required) {
          <span class="text-red-500 ml-1">*</span>
        }
      </label>
    }
  </div>
  
  @if (isEditing && field.type === 'text') {
    <input 
      type="text" 
      [value]="field.placeholder"
      (input)="onPlaceholderChange($any($event.target).value)"
      class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
      placeholder="Placeholder text"
    />
  }
  
  <!-- Field rendering based on type -->
  @switch (field.type) {
    @case ('text') {
      <input 
        type="text" 
        [placeholder]="field.placeholder || 'Enter text...'"
        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
        [readOnly]="!isEditing"
      />
    }
    @case ('textarea') {
      <textarea 
        [placeholder]="field.placeholder || 'Enter text...'"
        rows="4"
        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
        [readOnly]="!isEditing"
      ></textarea>
    }
    @case ('radio') {
      <div class="space-y-2">
        @for (option of field.options; track $index; let index = $index) {
          <div class="flex items-center">
            <input 
              type="radio" 
              [id]="field.id + '-' + index"
              [name]="field.id"
              class="mr-2 form-check-input"
              [disabled]="!isEditing"
            />
            @if (isEditing) {
              <input 
                type="text" 
                [value]="option"
                (input)="onOptionChange(index, $any($event.target).value)"
                class="flex-1 px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-primary"
              />
            } @else {
              <label [htmlFor]="field.id + '-' + index">{{ option }}</label>
            }
            @if (isEditing && field.options.length > 1) {
              <button 
                (click)="removeOption(index)"
                class="ml-2 text-red-500 hover:text-red-700"
              >
                <i class="fas fa-times"></i>
              </button>
            }
          </div>
        }
        @if (isEditing) {
          <button 
            (click)="addOption()"
            class="text-sm text-primary hover:text-indigo-700 flex items-center space-x-1"
          >
            <i class="fas fa-plus"></i>
            <span>Add Option</span>
          </button>
        }
      </div>
    }
    @case ('checkbox') {
      <div class="space-y-2">
        @for (option of field.options; track $index; let index = $index) {
          <div class="flex items-center">
            <input 
              type="checkbox" 
              [id]="field.id + '-' + index"
              class="mr-2 form-check-input"
              [disabled]="!isEditing"
            />
            @if (isEditing) {
              <input 
                type="text" 
                [value]="option"
                (input)="onOptionChange(index, $any($event.target).value)"
                class="flex-1 px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-primary"
              />
            } @else {
              <label [htmlFor]="field.id + '-' + index">{{ option }}</label>
            }
            @if (isEditing && field.options.length > 1) {
              <button 
                (click)="removeOption(index)"
                class="ml-2 text-red-500 hover:text-red-700"
              >
                <i class="fas fa-times"></i>
              </button>
            }
          </div>
        }
        @if (isEditing) {
          <button 
            (click)="addOption()"
            class="text-sm text-primary hover:text-indigo-700 flex items-center space-x-1"
          >
            <i class="fas fa-plus"></i>
            <span>Add Option</span>
          </button>
        }
      </div>
    }
    @case ('dropdown') {
      <div>
        <select 
          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
          [disabled]="!isEditing"
        >
          <option value="">Select an option</option>
          @for (option of field.options; track $index) {
            <option [value]="option">{{ option }}</option>
          }
        </select>
        @if (isEditing) {
          <div class="mt-2 space-y-2">
            @for (option of field.options; track $index; let index = $index) {
              <div class="flex items-center">
                <input 
                  type="text" 
                  [value]="option"
                  (input)="onOptionChange(index, $any($event.target).value)"
                  class="flex-1 px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-primary"
                />
                @if (field.options.length > 1) {
                  <button 
                    (click)="removeOption(index)"
                    class="ml-2 text-red-500 hover:text-red-700"
                  >
                    <i class="fas fa-times"></i>
                  </button>
                }
              </div>
            }
            <button 
              (click)="addOption()"
              class="text-sm text-primary hover:text-indigo-700 flex items-center space-x-1"
            >
              <i class="fas fa-plus"></i>
              <span>Add Option</span>
            </button>
          </div>
        }
      </div>
    }
    @case ('rating') {
      <app-star-rating [field]="field" [isEditing]="isEditing" />
    }
    @case ('date') {
      <input 
        type="date" 
        class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"
        [readOnly]="!isEditing"
      />
    }
    @case ('file') {
      <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center">
        <i class="fas fa-cloud-upload-alt text-3xl text-gray-400 mb-2"></i>
        <p class="text-gray-500">Click to upload or drag and drop</p>
        <input 
          type="file" 
          class="hidden"
          [disabled]="!isEditing"
        />
      </div>
    }
  }
  
  @if (isEditing) {
    <div class="flex justify-between items-center mt-2">
      <div class="flex items-center space-x-2">
        <input 
          type="checkbox" 
          [id]="'required-' + field.id"
          [checked]="field.required"
          (change)="onRequiredChange($any($event.target).checked)"
          class="rounded text-primary focus:ring-primary form-check-input"
        />
        <label [htmlFor]="'required-' + field.id" class="text-sm text-gray-600">Required</label>
      </div>
      
      <span class="text-xs text-gray-500 capitalize">{{ field.type }}</span>
    </div>
  }
</div>